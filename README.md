# PSmRemoteNG
A module to create mRemoteNG connection files from PowerShell. You can install this module from the PSGallery!

# Export-MRNGConnectionFile
## SYNOPSIS
Exports the mRemoteNG connection file with the encryption parameters specified.

## SYNTAX
```powershell
Export-MRNGConnectionFile [-RootNode] <RootNodeInfo> [-Path] <FileInfo> [[-EncryptionEngine] <String>] [[-BlockCipherMode] <String>] [[-KeyDerivationIterations] <Int32>] [-SortConnections] [<CommonParameters>]
```

## DESCRIPTION


## PARAMETERS
### -RootNode &lt;RootNodeInfo&gt;
The mRemoteNG root connections node generated by New-MRNGRootNode.
```
Required?                    true
Position?                    1
Default value
Accept pipeline input?       false
Accept wildcard characters?  false
```
 
### -Path &lt;FileInfo&gt;
The path to export the connection file to.
```
Required?                    true
Position?                    2
Default value
Accept pipeline input?       false
Accept wildcard characters?  false
```
 
### -EncryptionEngine &lt;String&gt;
The encryption engine to use when encrypting the connection passwords. Choices are 'AES', 'Serpent', and 'Twofish'. The default is 'AES'.
```
Required?                    false
Position?                    3
Default value                AES
Accept pipeline input?       false
Accept wildcard characters?  false
```
 
### -BlockCipherMode &lt;String&gt;
The block cipher mode to use when encrypting the connection passwords. Choices are 'GCM', 'CCM', and 'EAX'. The default is 'GCM'.
```
Required?                    false
Position?                    4
Default value                GCM
Accept pipeline input?       false
Accept wildcard characters?  false
```
 
### -KeyDerivationIterations &lt;Int32&gt;
The number of key derivation iterations to perform when encrypting the connection passwords. Valid values are in the range 1,000 to 50,000.
```
Required?                    false
Position?                    5
Default value                1000
Accept pipeline input?       false
Accept wildcard characters?  false
```
 
### -SortConnections &lt;SwitchParameter&gt;
Should the exported connections be sorted?
```
Required?                    false
Position?                    named
Default value                False
Accept pipeline input?       false
Accept wildcard characters?  false
```

## INPUTS


## OUTPUTS
System.Void

## NOTES


## EXAMPLES
### EXAMPLE 1
```powershell
PS C:\>Export-MRNGConnectionFile -RootNode $RootNode -Path .\Connections.xml (Get-Credential).Password -SortConnections
```


# Import-MRNGRootNode
## SYNOPSIS
Import an mRemoteNG root connections node from a confCons.xml file.

## SYNTAX
```powershell
Import-MRNGRootNode [-Path] <FileInfo> [[-EncryptionKey] <SecureString>] [<CommonParameters>]
```

## DESCRIPTION


## PARAMETERS
### -Path &lt;FileInfo&gt;

```
Required?                    true
Position?                    1
Default value
Accept pipeline input?       false
Accept wildcard characters?  false
```
 
### -EncryptionKey &lt;SecureString&gt;
The encryption key for the confCons.xml file.
```
Required?                    false
Position?                    2
Default value                ( ConvertTo-SecureString -String 'mR3m' -AsPlainText -Force )
Accept pipeline input?       false
Accept wildcard characters?  false
```

## INPUTS


## OUTPUTS
mRemoteNG.Tree.Root.RootNodeInfo

## NOTES


## EXAMPLES
### EXAMPLE 1
```powershell
PS C:\>$RootNode = Import-MRNGRootNode -Path .\confCons.xml -EncryptionKey ( Read-Host 'Encryiption Key' -AsSecureString )
```


# New-MRNGConnection
## SYNOPSIS
Create an mRemoteNG connection node.

## SYNTAX
```powershell
New-MRNGConnection [<CommonParameters>]
```

## DESCRIPTION


## PARAMETERS
## INPUTS


## OUTPUTS
mRemoteNG.Connection.ConnectionInfo

## NOTES


## EXAMPLES
### EXAMPLE 1
```powershell
PS C:\>New-MRNGConnection -Name 'Test Connection' -HostName '127.0.0.1' -Parent $RootNode -Protocol SSH2 -Inheritance (New-MRNGInheritanceConfiguration -EverythingInherited -Protocol:$false)
```

 
### EXAMPLE 2
```powershell
PS C:\>$Connection = New-MRNGConnection -Name 'Test Connection' -HostName '127.0.0.1'

$RootContainer.AddChild( $Connection )
```


# New-MRNGContainer
## SYNOPSIS
Create an mRemoteNG container node.

## SYNTAX
```powershell
New-MRNGContainer [<CommonParameters>]
```

## DESCRIPTION


## PARAMETERS
## INPUTS


## OUTPUTS
mRemoteNG.Container.ContainerInfo

## NOTES


## EXAMPLES
### EXAMPLE 1
```powershell
PS C:\>New-MRNGContainer -Name 'Test Container' -Parent $RootNode -Protocol SSH2
```

 
### EXAMPLE 2
```powershell
PS C:\>$Container = New-MRNGContainer -Name 'Test Container'

$RootContainer.AddChild( $Container )

$Container2 = New-MRNGContainer -Name 'Child Container'
$Container.AddChild( $Container2 )
```


# New-MRNGInheritanceConfiguration
## SYNOPSIS
Helper function to build an inheritance configuration.

## SYNTAX
```powershell
New-MRNGInheritanceConfiguration [<CommonParameters>]
```

## DESCRIPTION


## PARAMETERS
## INPUTS


## OUTPUTS
System.Collections.Hashtable

## NOTES


## EXAMPLES
### EXAMPLE 1
```powershell
PS C:\>New-MRNGInheritanceConfiguration -EverythingInherited -Icon:$false

# inherits everything except the icon
```


# New-MRNGRootNode
## SYNOPSIS
Create an empty mRemoteNG root connections node.

## SYNTAX
```powershell
New-MRNGRootNode [[-EncryptionKey] <SecureString>] [<CommonParameters>]
```

## DESCRIPTION


## PARAMETERS
### -EncryptionKey &lt;SecureString&gt;
The encryption key to use for this connections file.
```
Required?                    false
Position?                    1
Default value                ( ConvertTo-SecureString -String 'mR3m' -AsPlainText -Force )
Accept pipeline input?       false
Accept wildcard characters?  false
```

## INPUTS


## OUTPUTS
mRemoteNG.Tree.Root.RootNodeInfo

## NOTES


## EXAMPLES
### EXAMPLE 1
```powershell
PS C:\>$RootNode = New-MRNGRootNode
```
